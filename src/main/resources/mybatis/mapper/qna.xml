<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.skkcandle.dao.qnaDao">
	
	<select id="count" resultType="int">
		select count(*) from qna
	</select>
	
	<select id="selectByPage" parameterType="Pager" resultType="Qna">
		<![CDATA[
			select rnum, qnaid, username, qnatitle, qnacontent, qnaimage, qnadate, qnaanswer
	        from (
	           select rownum as rnum, qnaid, username, qnatitle, qnacontent, qnaimage, qnadate, qnaanswer
	           from (
	              select qnaid, u.username as username, qnatitle, qnacontent, qnaimage, qnadate, qnaanswer
	              from qna q inner join userinfo u on q.userid = u.userid
	              order by qnaid desc
	           )
	           where rownum <=#{endRowNo}
	           
	        )
	        where rnum >=#{startRowNo}
        ]]>
	</select>
	
	<insert id="write" parameterType="Qna">
		<selectKey keyProperty="qnaId" resultType="int" order="BEFORE"> 
			select seq_qna.nextval from dual
		</selectKey>
		 
		
		insert into board (
				bno, btitle, bcontent, mid, bdate, bhitcount, 
				battachoname, battachtype, battachsname, battachdata
		) values(
				#{bno}, #{btitle}, #{bcontent}, #{mid}, sysdate, 0, 
				#{battachoname, jdbcType=VARCHAR},
				#{battachtype, jdbcType=VARCHAR},
				#{battachsname, jdbcType=VARCHAR},
				#{battachdata, jdbcType=BLOB}
		)
	</insert>
	
</mapper>




